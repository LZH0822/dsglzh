# Docker Ansible 数据大屏操作指南

本文档提供了关于如何使用 Docker Ansible 数据大屏的详细操作说明。

## 访问数据大屏

1. 确保所有容器已启动并正常运行
2. 打开浏览器，访问 `http://您的服务器IP地址`
3. 数据大屏应该自动加载并显示主机信息

## 界面说明

数据大屏界面分为以下几个主要部分：

### 顶部导航栏

- **标题**: "Ansible Dashboard"
- **刷新按钮**: 点击可刷新所有数据
- **添加主机按钮**: 点击可打开添加主机对话框

### 系统状态区域

显示系统整体状态信息：

- **总主机数**: 系统中配置的主机总数
- **在线主机数**: 当前可连接的主机数量
- **离线主机数**: 当前无法连接的主机数量
- **状态进度条**: 直观显示在线/离线主机比例

### 资源使用图表

使用柱状图显示各主机的资源使用情况：

- **CPU 核心数**: 每台主机的 CPU 核心数量
- **内存 (GB)**: 每台主机的内存大小（以 GB 为单位）
- **磁盘 (TB)**: 每台主机的磁盘容量（以 TB 为单位）

### 主机状态表格

详细列出所有主机的信息：

- **主机名**: 主机的名称
- **IP 地址**: 主机的 IP 地址
- **状态**: 在线/离线状态
- **操作系统**: 主机运行的操作系统
- **CPU 核心数**: CPU 核心数量
- **内存 (MB)**: 内存大小（以 MB 为单位）
- **磁盘 (GB)**: 磁盘容量（以 GB 为单位）
- **运行时间 (小时)**: 系统运行时间
- **操作**: 编辑和删除按钮

### 主机卡片

以卡片形式展示每个主机的信息：

- **主机名和 IP**: 主机的名称和 IP 地址
- **状态**: 在线/离线状态（卡片顶部颜色也会相应变化）
- **系统信息**: 操作系统、CPU、内存、磁盘和运行时间
- **操作按钮**: 编辑和删除按钮

## 主机管理操作

### 刷新数据

1. 点击顶部导航栏中的"刷新"按钮
2. 系统将重新获取所有主机的最新信息
3. 页面上的数据将自动更新

### 添加主机

1. 点击顶部导航栏中的"添加主机"按钮
2. 在弹出的对话框中填写以下信息：
   - **主机名**: 输入主机的名称（例如：host04）
   - **IP 地址**: 输入主机的 IP 地址（例如：192.168.31.203）
   - **用户名**: 输入 SSH 连接使用的用户名（默认为 root）
3. 点击"保存主机"按钮
4. 系统将自动添加主机并刷新数据

### 编辑主机

1. 在主机表格或主机卡片中找到要编辑的主机
2. 点击对应的编辑按钮（铅笔图标）
3. 在弹出的对话框中修改以下信息：
   - **主机名**: 修改主机的名称
   - **IP 地址**: 修改主机的 IP 地址
   - **用户名**: 修改 SSH 连接使用的用户名
4. 点击"更新主机"按钮
5. 系统将自动更新主机信息并刷新数据

### 删除主机

1. 在主机表格或主机卡片中找到要删除的主机
2. 点击对应的删除按钮（垃圾桶图标）
3. 在弹出的确认对话框中点击"确定"
4. 系统将自动删除主机并刷新数据

## 数据解读

### 主机状态

- **在线（绿色）**: 主机可以正常连接，Ansible ping 测试成功
- **离线（红色）**: 主机无法连接，Ansible ping 测试失败

### 系统信息

- **操作系统**: 显示主机运行的操作系统名称和版本
- **CPU 核心数**: 显示主机的 CPU 核心数量
- **内存**: 显示主机的总内存大小
- **磁盘**: 显示主机的总磁盘容量
- **运行时间**: 显示主机已运行的小时数

## 常见问题解决

### 数据加载缓慢

如果数据加载速度较慢：

1. 检查网络连接是否稳定
2. 确认目标主机是否可以正常访问
3. 查看后端容器日志是否有错误信息：
   ```bash
   docker logs docker-ansible-dashboard_backend_1
   ```

### 主机状态显示错误

如果主机状态显示不正确：

1. 确认 SSH 密钥认证是否正确设置
2. 检查主机是否可以正常连接：
   ```bash
   ssh root@主机IP
   ```
3. 检查 Ansible 配置是否正确：
   ```bash
   docker exec -it docker-ansible-dashboard_ansible_1 cat /etc/ansible/hosts
   ```

### 添加或编辑主机失败

如果添加或编辑主机操作失败：

1. 确认输入的 IP 地址格式是否正确
2. 检查后端容器日志是否有错误信息：
   ```bash
   docker logs docker-ansible-dashboard_backend_1
   ```
3. 确认 Ansible 主机文件是否有写入权限：
   ```bash
   docker exec -it docker-ansible-dashboard_ansible_1 ls -la /etc/ansible/hosts
   ```

## 技巧和建议

1. **定期刷新数据**: 点击刷新按钮获取最新的主机状态和系统信息
2. **使用表格视图**: 表格视图可以同时查看所有主机的详细信息
3. **使用卡片视图**: 卡片视图提供更直观的主机状态展示
4. **检查连接**: 如果添加新主机后无法连接，可以使用 `check_connectivity.sh` 脚本进行检查
5. **查看日志**: 如果遇到问题，查看容器日志可以帮助诊断问题：
   ```bash
   docker-compose logs
   ``` 